<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <style>
      body {
        font-family: "Inter", sans-serif;
        font-size: 12px;
        padding: 16px;
        margin: 0;
        color: #333;
        background: #fff;
        line-height: 1.4;
      }
      .header {
        text-align: center;
        margin-bottom: 20px;
        padding-bottom: 16px;
        border-bottom: 1px solid #eee;
      }
      .title {
        font-size: 18px;
        font-weight: 600;
        color: #333;
        margin-bottom: 4px;
      }
      .subtitle {
        font-size: 11px;
        color: #666;
        line-height: 1.3;
      }
      .banner {
        background: #dcfce7;
        border: 1px solid #16a34a;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 16px;
        text-align: center;
      }
      .banner-title {
        font-size: 12px;
        font-weight: 600;
        color: #15803d;
        margin-bottom: 4px;
      }
      .banner-text {
        font-size: 10px;
        color: #166534;
      }
      .tabs {
        display: flex;
        margin-bottom: 16px;
        border-radius: 6px;
        overflow: hidden;
        border: 1px solid #e5e7eb;
        background: #f9fafb;
      }
      .tab {
        flex: 1;
        padding: 10px 12px;
        font-size: 11px;
        font-weight: 500;
        text-align: center;
        cursor: pointer;
        transition: all 0.2s;
        border: none;
        background: transparent;
      }
      .tab.active {
        background: #2563eb;
        color: white;
      }
      .tab:hover:not(.active) {
        background: #e5e7eb;
      }
      .info-card {
        background: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 16px;
      }
      .info-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }
      .info-title {
        font-size: 12px;
        font-weight: 600;
      }
      .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 8px;
        font-size: 10px;
      }
      .info-item {
        display: flex;
        align-items: center;
        gap: 4px;
        margin-bottom: 2px;
      }
      .quick-buttons {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 4px;
        margin-bottom: 8px;
      }
      .quick-button {
        padding: 6px 8px;
        font-size: 10px;
        background: #f3f4f6;
        border: 1px solid #d1d5db;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
      }
      .quick-button:hover {
        background: #e5e7eb;
      }
      .quick-button.selected {
        background: #dbeafe;
        border-color: #2563eb;
        color: #1d4ed8;
      }
      .input-section {
        margin-bottom: 16px;
      }
      .label {
        display: block;
        font-size: 11px;
        font-weight: 600;
        margin-bottom: 4px;
      }
      .hint {
        font-size: 10px;
        color: #666;
        margin-bottom: 6px;
      }
      .input {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 12px;
        box-sizing: border-box;
        margin-bottom: 8px;
      }
      .input:focus {
        outline: none;
        border-color: #0066cc;
      }
      .button {
        width: 100%;
        padding: 10px;
        background: #0066cc;
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
      }
      .button:hover {
        background: #0056b3;
      }
      .button:disabled {
        background: #ccc;
        cursor: not-allowed;
      }
      .status {
        padding: 8px;
        border-radius: 4px;
        font-size: 11px;
        margin-bottom: 12px;
      }
      .status.success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
      }
      .status.error {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
      }
      .status.info {
        background: #d1ecf1;
        color: #0c5460;
        border: 1px solid #bee5eb;
      }
      .status.warning {
        background: #fff3cd;
        color: #856404;
        border: 1px solid #ffeaa7;
      }
      .stats {
        background: #fff3cd;
        border: 1px solid #ffc107;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 16px;
      }
      .stats-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
      }
      .stats-title {
        font-size: 12px;
        font-weight: 600;
        color: #856404;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 8px;
        margin-bottom: 8px;
      }
      .stat {
        padding: 6px 8px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 4px;
        text-align: center;
      }
      .stat-number {
        font-size: 14px;
        font-weight: 600;
        color: #856404;
      }
      .stat-label {
        font-size: 9px;
        color: #856404;
        margin-top: 2px;
      }
      .found-items {
        background: #d4edda;
        border: 1px solid #c3e6cb;
        border-radius: 6px;
        padding: 12px;
        margin-bottom: 16px;
      }
      .found-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 8px;
      }
      .found-title {
        font-size: 12px;
        font-weight: 600;
        color: #155724;
      }
      .found-item {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 6px;
        padding: 6px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 4px;
      }
      .found-icon {
        font-size: 12px;
      }
      .found-details {
        flex: 1;
      }
      .found-name {
        font-size: 11px;
        font-weight: 600;
        color: #155724;
        margin-bottom: 2px;
      }
      .found-badges {
        display: flex;
        gap: 4px;
      }
      .badge {
        font-size: 9px;
        padding: 2px 4px;
        border-radius: 3px;
        border: 1px solid;
      }
      .badge.variable {
        background: #d4edda;
        color: #155724;
        border-color: #c3e6cb;
      }
      .badge.style {
        background: #e2e3ff;
        color: #3d4ed8;
        border-color: #c7d2fe;
      }
      .badge.layer {
        background: #fef3c7;
        color: #92400e;
        border-color: #fcd34d;
      }
      .badge.remote {
        background: #fff3cd;
        color: #856404;
        border-color: #ffeaa7;
      }
      .badge.local {
        background: #f8f9fa;
        color: #495057;
        border-color: #dee2e6;
      }
      .results {
        margin-bottom: 16px;
      }
      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }
      .results-title {
        font-size: 12px;
        font-weight: 600;
      }
      .results-count {
        font-size: 10px;
        background: #f0f0f0;
        padding: 2px 6px;
        border-radius: 10px;
      }
      .context {
        font-size: 10px;
        color: #666;
        font-style: italic;
        margin-bottom: 8px;
      }
      .results-list {
        max-height: 300px;
        overflow-y: auto;
        border: 1px solid #eee;
        border-radius: 6px;
        background: white;
      }
      .result {
        padding: 12px;
        border-bottom: 1px solid #f0f0f0;
        transition: all 0.2s;
      }
      .result:last-child {
        border-bottom: none;
      }
      .result:hover {
        background: #f0f8ff;
      }
      .result-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 4px;
      }
      .result-icon {
        color: #666;
      }
      .result-name {
        font-size: 12px;
        font-weight: 500;
        flex: 1;
      }
      .result-badge {
        font-size: 9px;
        padding: 2px 4px;
        background: #f0f0f0;
        color: #666;
        border-radius: 3px;
      }
      .result-path {
        font-size: 10px;
        color: #888;
        font-family: monospace;
        margin-bottom: 6px;
      }
      .result-found {
        border-top: 1px solid #f0f0f0;
        padding-top: 6px;
        margin-top: 6px;
      }
      .result-found-title {
        font-size: 10px;
        font-weight: 600;
        color: #666;
        margin-bottom: 4px;
      }
      .result-found-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 4px;
      }
      .no-results {
        text-align: center;
        padding: 24px;
        background: white;
        border: 1px solid #eee;
        border-radius: 6px;
      }
      .no-results-icon {
        font-size: 24px;
        margin-bottom: 8px;
        color: #ccc;
      }
      .no-results-title {
        font-size: 12px;
        font-weight: 600;
        margin-bottom: 4px;
      }
      .no-results-text {
        font-size: 10px;
        color: #666;
        margin-bottom: 12px;
      }
      .tips {
        background: #f8f9fa;
        padding: 8px;
        border-radius: 4px;
        font-size: 10px;
        color: #666;
      }
      .tips-title {
        font-weight: 600;
        margin-bottom: 4px;
      }
      .hidden {
        display: none;
      }
      .spinner {
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        from {
          transform: rotate(0deg);
        }
        to {
          transform: rotate(360deg);
        }
      }
    </style>
  </head>
  <body>
    <div class="banner">
      <div class="banner-title">🔍 JustGo Audit - Design System Audit Tool</div>
      <div class="banner-text">
        Comprehensive design system audit for variables, styles, and layer name
        matching
      </div>
    </div>

    <div class="header">
      <div class="title">🔍 JustGo Audit</div>
      <div class="subtitle">
        Design system audit tool for finding layers using variables, styles, and
        strict layer name matching with quality assurance features.
      </div>
    </div>

    <div class="tabs">
      <button id="variables-tab" class="tab active">
        🔗 Variables & Styles
      </button>
      <button id="layers-tab" class="tab">🏷️ Layer Names</button>
    </div>

    <div id="variables-mode">
      <div class="info-card">
        <div class="info-header">
          <div class="info-title">🚀 Design System Audit:</div>
          <div style="display: flex; gap: 4px">
            <div class="badge local">🏠 Local</div>
            <div class="badge remote">🌐 Remote</div>
          </div>
        </div>
        <div class="info-grid">
          <div>
            <div style="font-weight: 600; margin-bottom: 4px; color: #0066cc">
              Variables:
            </div>
            <div class="info-item"><span>🎨</span><span>Colors</span></div>
            <div class="info-item"><span>📏</span><span>Numbers</span></div>
            <div class="info-item"><span>📝</span><span>Strings</span></div>
            <div class="info-item"><span>✅</span><span>Booleans</span></div>
          </div>
          <div>
            <div style="font-weight: 600; margin-bottom: 4px; color: #6f42c1">
              Styles:
            </div>
            <div class="info-item"><span>🎨</span><span>Paint</span></div>
            <div class="info-item"><span>📝</span><span>Text</span></div>
            <div class="info-item"><span>✨</span><span>Effect</span></div>
            <div class="info-item"><span>📐</span><span>Grid</span></div>
          </div>
        </div>
      </div>
    </div>

    <div id="layers-mode" class="hidden">
      <div class="info-card">
        <div class="info-header">
          <div class="info-title">🔒 STRICT Layer Name Audit:</div>
          <div class="badge layer">🚫 Components Excluded</div>
        </div>
        <div style="font-size: 10px; color: #666; margin-bottom: 8px">
          Audit layers by exact name within selected frames or entire page.
          Components and instances automatically excluded.
        </div>
        <div class="quick-buttons">
          <div class="quick-button" data-layer="heading-text">heading-text</div>
          <div class="quick-button" data-layer="title-text">title-text</div>
          <div class="quick-button" data-layer="subtitle-text">
            subtitle-text
          </div>
          <div class="quick-button" data-layer="body-text">body-text</div>
          <div class="quick-button" data-layer="highlighted-text">
            highlighted-text
          </div>
          <div class="quick-button" data-layer="info-text">info-text</div>
          <div class="quick-button" data-layer="caption-text">caption-text</div>
          <div class="quick-button" data-layer="overline-text">
            overline-text
          </div>
        </div>
      </div>
    </div>

    <div class="input-section">
      <label class="label" for="search-input" id="search-label"
        >Enter variable or style name:</label
      >
      <div class="hint" id="search-hint">
        Try: "Colors/warning/100", "button-primary", "heading-large", etc.
      </div>
      <input
        type="text"
        id="search-input"
        class="input"
        placeholder="Colors/warning/100"
      />
      <button id="search-button" class="button">
        <span id="search-icon">🔍</span>
        <span id="search-text">Start Audit</span>
      </button>
    </div>

    <div id="status" class="status hidden"></div>

    <div id="search-stats" class="stats hidden">
      <div class="stats-header">
        <div style="font-size: 16px">📊</div>
        <div id="stats-title" class="stats-title"></div>
      </div>
      <div class="stats-grid">
        <div class="stat">
          <div id="stat-checked" class="stat-number">0</div>
          <div class="stat-label">Nodes<br />Audited</div>
        </div>
        <div class="stat">
          <div id="stat-with-items" class="stat-number">0</div>
          <div class="stat-label">With<br />Design Tokens</div>
        </div>
        <div class="stat">
          <div id="stat-matching" class="stat-number">0</div>
          <div class="stat-label">Matching<br />Criteria</div>
        </div>
      </div>
    </div>

    <div id="found-items" class="found-items hidden">
      <div class="found-header">
        <div style="font-size: 16px">🎯</div>
        <div id="found-title" class="found-title"></div>
      </div>
      <div id="found-list"></div>
    </div>

    <div id="results-section" class="results hidden">
      <div class="results-header">
        <div class="results-title">Audit Results:</div>
        <div id="results-count" class="results-count">0 found</div>
      </div>
      <div id="context" class="context"></div>
      <div id="results-container"></div>
    </div>

    <script>
      const elements = {
        input: document.getElementById("search-input"),
        button: document.getElementById("search-button"),
        icon: document.getElementById("search-icon"),
        text: document.getElementById("search-text"),
        label: document.getElementById("search-label"),
        hint: document.getElementById("search-hint"),
        status: document.getElementById("status"),
        variablesTab: document.getElementById("variables-tab"),
        layersTab: document.getElementById("layers-tab"),
        variablesMode: document.getElementById("variables-mode"),
        layersMode: document.getElementById("layers-mode"),
        quickButtons: document.querySelectorAll(".quick-button"),
        stats: document.getElementById("search-stats"),
        statsTitle: document.getElementById("stats-title"),
        statChecked: document.getElementById("stat-checked"),
        statWithItems: document.getElementById("stat-with-items"),
        statMatching: document.getElementById("stat-matching"),
        foundItems: document.getElementById("found-items"),
        foundTitle: document.getElementById("found-title"),
        foundList: document.getElementById("found-list"),
        results: document.getElementById("results-section"),
        resultsCount: document.getElementById("results-count"),
        context: document.getElementById("context"),
        container: document.getElementById("results-container"),
      };

      let isSearching = false;
      let currentMode = "variables";

      function showStatus(message, type = "info") {
        elements.status.textContent = message;
        elements.status.className = "status " + type;
        elements.status.classList.remove("hidden");
      }

      function hideStatus() {
        elements.status.classList.add("hidden");
      }

      function setSearching(searching) {
        isSearching = searching;
        elements.button.disabled = searching;
        if (searching) {
          elements.icon.textContent = "⏳";
          elements.icon.classList.add("spinner");
          elements.text.textContent =
            currentMode === "variables"
              ? "Auditing design tokens..."
              : "Auditing layer names...";
        } else {
          elements.icon.textContent = "🔍";
          elements.icon.classList.remove("spinner");
          elements.text.textContent = "Start Audit";
        }
      }

      function switchMode(mode) {
        currentMode = mode;
        elements.variablesTab.classList.toggle("active", mode === "variables");
        elements.layersTab.classList.toggle("active", mode === "layers");
        elements.variablesMode.classList.toggle("hidden", mode !== "variables");
        elements.layersMode.classList.toggle("hidden", mode !== "layers");

        if (mode === "variables") {
          elements.label.textContent = "Enter variable or style name:";
          elements.hint.textContent =
            'Try: "Colors/warning/100", "button-primary", etc.';
          elements.input.placeholder = "Colors/warning/100";
        } else {
          elements.label.textContent = "Enter exact layer name:";
          elements.hint.textContent =
            "Only allowed: heading-text, title-text, subtitle-text, body-text, etc.";
          elements.input.placeholder = "heading-text";
        }

        hideStatus();
        elements.foundItems.classList.add("hidden");
        elements.results.classList.add("hidden");
        elements.stats.classList.add("hidden");
        elements.quickButtons.forEach((btn) =>
          btn.classList.remove("selected"),
        );
      }

      function displayStats(stats, scopeInfo) {
        if (!stats) {
          elements.stats.classList.add("hidden");
          return;
        }

        let title = "Audit Statistics:";
        if (
          currentMode === "variables" &&
          scopeInfo &&
          scopeInfo.expandedToPage
        ) {
          title = scopeInfo.searchedSelection
            ? "🧠 Smart Audit: Selection → Page"
            : "🧠 Smart Audit: Page scope";
        } else if (currentMode === "layers") {
          title = "🔒 Strict Layer Audit:";
        }

        elements.statsTitle.textContent = title;
        elements.statChecked.textContent = stats.checkedNodes;
        elements.statWithItems.textContent = stats.nodesWithItems;
        elements.statMatching.textContent = stats.matchingNodes;
        elements.stats.classList.remove("hidden");
      }

      function getIcons() {
        return {
          variable: { COLOR: "🎨", FLOAT: "📏", STRING: "📝", BOOLEAN: "✅" },
          style: { PAINT: "🎨", TEXT: "📝", EFFECT: "✨", GRID: "📐" },
          layer: {
            RECTANGLE: "⬜",
            GROUP: "📁",
            VECTOR: "🔺",
            COMPONENT: "🧩",
            TEXT: "📝",
            FRAME: "🖼️",
            ELLIPSE: "⭕",
          },
        };
      }

      function displayFoundItems(items) {
        if (!items || items.length === 0 || currentMode === "layers") {
          elements.foundItems.classList.add("hidden");
          return;
        }

        const icons = getIcons();
        elements.foundTitle.textContent = `Found ${items.length} matching design tokens:`;
        elements.foundList.innerHTML = "";

        items.forEach((item) => {
          const itemEl = document.createElement("div");
          itemEl.className = "found-item";
          const icon =
            item.type === "VARIABLE"
              ? icons.variable[item.resolvedType] || "🔧"
              : icons.style[item.styleType] || "🔧";
          const badges = [
            `<span class="badge ${item.type.toLowerCase()}">${
              item.type === "VARIABLE" ? "🔗 Variable" : "🎨 Style"
            }</span>`,
            `<span class="badge">${
              item.type === "VARIABLE" ? item.resolvedType : item.styleType
            }</span>`,
            `<span class="badge ${item.isRemote ? "remote" : "local"}">${
              item.isRemote ? "🌐 Remote" : "🏠 Local"
            }</span>`,
          ];

          itemEl.innerHTML = `
                    <div class="found-icon">${icon}</div>
                    <div class="found-details">
                        <div class="found-name">${item.name}</div>
                        <div class="found-badges">${badges.join("")}</div>
                    </div>
                `;
          elements.foundList.appendChild(itemEl);
        });
        elements.foundItems.classList.remove("hidden");
      }

      function displayResults(results, searchTerm, searchContext, searchType) {
        elements.resultsCount.textContent = `${results.length} found`;
        elements.context.textContent = `Audited scope: ${searchContext}`;

        if (results.length === 0) {
          const tips =
            searchType === "LAYER_NAME"
              ? '<div class="tips-title">🔒 Strict Layer Audit Tips:</div><div>• Only exact layer name matching</div><div>• Components & instances excluded</div><div>• Use allowed names only</div>'
              : '<div class="tips-title">🔍 Design System Audit Tips:</div><div>• Comprehensive variables & styles detection</div><div>• Smart scope with automatic expansion</div><div>• Try different design token names</div>';

          elements.container.innerHTML = `
                    <div class="no-results">
                        <div class="no-results-icon">🔍</div>
                        <div class="no-results-title">No layers found</div>
                        <div class="no-results-text">No layers found ${
                          searchType === "LAYER_NAME" ? "with name" : "using"
                        } "${searchTerm}"</div>
                        <div class="tips">${tips}</div>
                    </div>
                `;
        } else {
          const icons = getIcons();
          const resultsList = document.createElement("div");
          resultsList.className = "results-list";

          results.forEach((result) => {
            const resultEl = document.createElement("div");
            resultEl.className = "result";

            let foundItemsHtml = "";
            if (
              result.foundItems &&
              result.foundItems.length > 0 &&
              searchType !== "LAYER_NAME"
            ) {
              const badges = result.foundItems
                .map((item) => {
                  const icon =
                    item.type === "VARIABLE"
                      ? icons.variable[item.resolvedType] || "🔧"
                      : icons.style[item.styleType] || "🔧";
                  return `<span class="badge ${item.type.toLowerCase()}">${icon} ${
                    item.name
                  }</span>`;
                })
                .join("");
              foundItemsHtml = `<div class="result-found"><div class="result-found-title">Design Tokens Found:</div><div class="result-found-badges">${badges}</div></div>`;
            } else if (searchType === "LAYER_NAME") {
              foundItemsHtml = `<div class="result-found"><div class="result-found-title">Audit Match:</div><div class="result-found-badges"><span class="badge layer">🏷️ Exact Layer Name</span><span class="badge">🔒 STRICT</span></div></div>`;
            }

            resultEl.innerHTML = `
                        <div class="result-header">
                            <div class="result-icon">${
                              icons.layer[result.type] || "⬜"
                            }</div>
                            <div class="result-name">${result.name}</div>
                            <div class="result-badge">${result.type}</div>
                        </div>
                        <div class="result-path">${result.path}</div>
                        ${foundItemsHtml}
                    `;
            resultsList.appendChild(resultEl);
          });

          elements.container.innerHTML = "";
          elements.container.appendChild(resultsList);
        }
        elements.results.classList.remove("hidden");
      }

      function handleSearch() {
        const searchTerm = elements.input.value.trim();
        if (!searchTerm) {
          showStatus("Please enter a search term", "error");
          return;
        }

        setSearching(true);
        hideStatus();
        elements.foundItems.classList.add("hidden");
        elements.results.classList.add("hidden");

        const messageType =
          currentMode === "variables"
            ? "find-variables-and-styles"
            : "find-layer-names";
        parent.postMessage(
          { pluginMessage: { type: messageType, searchTerm } },
          "*",
        );
      }

      // Event listeners
      elements.button.addEventListener("click", handleSearch);
      elements.input.addEventListener("keypress", (e) => {
        if (e.key === "Enter") handleSearch();
      });
      elements.variablesTab.addEventListener("click", () =>
        switchMode("variables"),
      );
      elements.layersTab.addEventListener("click", () => switchMode("layers"));

      elements.quickButtons.forEach((button) => {
        button.addEventListener("click", function () {
          elements.input.value = this.dataset.layer;
          elements.quickButtons.forEach((btn) =>
            btn.classList.remove("selected"),
          );
          this.classList.add("selected");
        });
      });

      // Handle messages from plugin
      window.onmessage = function (event) {
        const msg = event.data.pluginMessage;
        if (!msg) return;

        switch (msg.type) {
          case "search-results":
            setSearching(false);
            if (msg.searchStatistics)
              displayStats(msg.searchStatistics, msg.scopeInfo);

            if (msg.searchType === "LAYER_NAME") {
              if (msg.strictError) {
                showStatus(`🔒 ${msg.strictError}`, "error");
              } else if (msg.results.length > 0) {
                showStatus(
                  `✅ Audit found ${msg.results.length} layers named "${msg.searchTerm}"`,
                  "success",
                );
              } else {
                showStatus(
                  `⚠️ Audit found no layers named "${msg.searchTerm}"`,
                  "warning",
                );
              }
            } else {
              if (msg.scopeInfo && msg.scopeInfo.expandedToPage) {
                const reason = !msg.scopeInfo.selectionHadVariables
                  ? "no design tokens in selection"
                  : "no matches in selection";
                if (msg.results.length > 0) {
                  showStatus(
                    `🧠 Smart audit expanded to page - found ${msg.results.length} layers`,
                    "success",
                  );
                } else {
                  showStatus(
                    `🧠 Expanded to page (${reason}) but no matches found`,
                    "warning",
                  );
                }
              } else if (msg.results.length > 0) {
                showStatus(
                  `✅ Audit found ${msg.results.length} layers using "${msg.searchTerm}"`,
                  "success",
                );
              }
            }

            if (msg.foundItems && msg.foundItems.length > 0)
              displayFoundItems(msg.foundItems);
            displayResults(
              msg.results,
              msg.searchTerm,
              msg.context,
              msg.searchType,
            );
            break;

          case "error":
            setSearching(false);
            showStatus(msg.message, "error");
            break;
        }
      };
    </script>
  </body>
</html>
